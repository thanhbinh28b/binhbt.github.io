## Má»¥c lá»¥c

- [Tá»•ng quan vá» Dá»± Ã¡n](#Tá»•ng-quan-vá»-Dá»±-Ã¡n)
  - [Thá»ƒ lá»‡ cá»§a chÆ°Æ¡ng trÃ¬nh hoÃ n tiá»n](#thá»ƒ-lá»‡-cá»§a-chÆ°Æ¡ng-trÃ¬nh-hoÃ n-tiá»n:)
  - [NguyÃªn táº¯c hoÃ n tiá»n](#nguyÃªn-táº¯c-hoÃ n-tiá»n)
- [HÆ°á»›ng dáº«n sá»­ dá»¥ng](#HÆ°á»›ng-dáº«n-sá»­-dá»¥ng)
  - [CÃ i Ä‘áº·t](#CÃ i-Ä‘áº·t)
  - [Cáº¥u trÃºc file bÃ¡o cÃ¡o](#Cáº¥u-trÃºc-file-bÃ¡o-cÃ¡o:)
  - [CÃ¡c bÆ°á»›c cháº¡y bÃ¡o cÃ¡o](#CÃ¡c-bÆ°á»›c-cháº¡y-bÃ¡o-cÃ¡o:)
- [Chi tiáº¿t vá» dá»± Ã¡n](#Chi-tiáº¿t-vá»-dá»±-Ã¡n)
  - [Cáº¥u trÃºc File](#Cáº¥u-trÃºc-File)
  - [Cáº¥u trÃºc cÃ¢u lá»‡nh cháº¡y tá»± Ä‘á»™ng](#Cáº¥u-trÃºc-cÃ¢u-lá»‡nh-cháº¡y-tá»±-Ä‘á»™ng)
  - [Kháº£ nÄƒng nÃ¢ng cáº¥p](#Kháº£-nÄƒng-nÃ¢ng-cáº¥p)
- [GÃ³p Ã½ vÃ  Ä‘Ã³ng gÃ³p](#GÃ³p-Ã½-vÃ -Ä‘Ã³ng-gÃ³p) 
- [LÆ°u Ã½](#LÆ°u-Ã½)

## Tá»•ng quan vá» Dá»± Ã¡n
Dá»± Ã¡n dá»± trÃªn yÃªu cáº§u xá»­ lÃ½ dá»¯ liá»‡u khÃ¡ch hÃ ng cho ChÆ°Æ¡ng trÃ¬nh:  "HoÃ n tiá»n (Cashback) cho cÃ¡c khÃ¡ch hÃ ng sá»­ dá»¥ng tháº» áº£o - Virtual credit card (VCC) 
### Thá»ƒ lá»‡ cá»§a chÆ°Æ¡ng trÃ¬nh hoÃ n tiá»n:
- **Chá»‰ tiÃªu xÃ©t hoÃ n tiá»n:** LÃ  Tá»•ng sá»‘ tiá»n chi tiÃªu Ä‘Ã£ Ä‘Æ°á»£c quy Ä‘á»•i vá» USD trong má»™t ká»³ sao kÃª (Ká»³ sao kÃª: TÃ­nh Ä‘Æ°á»£c tá»« ngÃ y Ä‘áº§u tiÃªn Ä‘áº¿n ngÃ y cuá»‘i cÃ¹ng cá»§a thÃ¡ng). Chá»‰ tiÃªu xÃ©t hoÃ n tiá»n pháº£i Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t Ä‘Æ°á»£c hoÃ n tiá»n (cÃ³ tá»· lá»‡ hoÃ n tiá»n > 0)
- **Tá»· lá»‡ giao dá»‹ch tháº¥t báº¡i:** Tá»· lá»‡ giao dá»‹ch tháº¥t báº¡i trong má»™t ká»³ sao kÃª tháº¥p hÆ¡n 10%
- **GiÃ¡ trá»‹ trung bÃ¬nh cá»§a má»—i giao dá»‹ch - Average Transaction Value (ATV):** ATV pháº£i Ä‘áº¡t trÃªn 100 USD
### NguyÃªn táº¯c hoÃ n tiá»n 
KhÃ¡ch hÃ ng Ä‘Ã¡p á»©ng Ä‘Æ°á»£c thá»ƒ lá»‡ chÆ°Æ¡ng trÃ¬nh sáº½ Ä‘Æ°á»£c hoÃ n tiá»n theo cÃ´ng thá»©c sau:
<p align="center">
<b>GiÃ¡ trá»‹ hoÃ n tiá»n (Cashback Amount) = Chá»‰ tiÃªu xÃ©t hoÃ n tiá»n * Tá»· lá»‡ hoÃ n tiá»n</b>
</p>
Trong Ä‘Ã³, Tá»· lá»‡ hoÃ n tiá»n Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng Chá»‰ tiÃªu hoÃ n tiá»n theo báº£ng sau: <br>

| STT  | Chá»‰ tiÃªu xÃ©t hoÃ n tiá»n                                       | Tá»· lá»‡ hoÃ n tiá»n |
|------|--------------------------------------------------------------|-----------------|
| 1    | Tá»« 20,000 USD Ä‘áº¿n dÆ°á»›i 50,000 USD                            | 0.1%            |
| 2    | Tá»« 50,000 USD Ä‘áº¿n dÆ°á»›i 100,000 USD                           | 0.3%            |
| 3    | Tá»« 100,000 USD Ä‘áº¿n dÆ°á»›i 500,000 USD                          | 0.4%            |
| 4    | Tá»« 500,000 USD Ä‘áº¿n dÆ°á»›i 1,000,000 USD                        | 0.5%            |
| 5    | Tá»« 1,000,000 USD Ä‘áº¿n dÆ°á»›i 5,000,000 USD                      | 0.6%            |
| 6    | TrÃªn 5,000,000 USD                                           | 0.7%            |

[ğŸ” Quay vá» Ä‘áº§u](#má»¥c-lá»¥c)

## HÆ°á»›ng dáº«n sá»­ dá»¥ng
Dá»± Ã¡n Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i vÃ  cháº¡y hoÃ n toÃ n tá»± Ä‘á»™ng trong file Excel dáº¡ng xlsb

### CÃ i Ä‘áº·t
Äá»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c BÃ¡o cÃ¡o tá»± Ä‘á»™ng, cÃ¡c báº¡n sáº½ cáº§n báº­t VBA trong Excel theo hÆ°á»›ng dáº«n cá»§a Microsoft [táº¡i Ä‘Ã¢y](https://support.microsoft.com/en-us/office/enable-or-disable-macros-in-microsoft-365-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6)

### Cáº¥u trÃºc file bÃ¡o cÃ¡o:
```
Cashback Report for date of 2025.06.xlsb/
â”œâ”€â”€ Report/     # BÃ¡o cÃ¡o khÃ¡ch hÃ ng Ä‘Æ°á»£c hoÃ n tiá»n trong ká»³ bÃ¡o cÃ¡o
â”œâ”€â”€ Check1/     # BÆ°á»›c 1: TÃ­nh Chá»‰ tiÃªu xÃ©t hoÃ n tiá»n vÃ  GiÃ¡ trá»‹ trung bÃ¬nh cá»§a má»—i giao dá»‹ch
â”œâ”€â”€ Check2/     # BÆ°á»›c 2: TÃ­nh tá»· lá»‡ giao dá»‹ch tháº¥t báº¡i
â”œâ”€â”€ Check3/     # BÆ°á»›c 3: Tá»•ng há»£p dá»¯ liá»‡u vá» 3 chá»‰ tiÃªu Ä‘Ã£ Ä‘Æ°á»£c tÃ­nh táº¡i BÆ°á»›c 1 vÃ  BÆ°á»›c 2, kiá»ƒm tra cÃ¡c khÃ¡ch Ä‘á»§ Ä‘iá»u kiá»‡n Ä‘Æ°á»£c hoÃ n tiá»n
â”œâ”€â”€ Auth/       # Dá»¯ liá»‡u Ä‘áº§u vÃ o: Dá»¯ liá»‡u vá» Authorization Transaction
â”œâ”€â”€ Settle/     # Dá»¯ liá»‡u Ä‘áº§u vÃ o: Dá»¯ liá»‡u vá» Settlement Transaction
â””â”€â”€ Note        # Bao gá»“m nÃºt Run Ä‘á»ƒ cháº¡y bÃ¡o cÃ¡o, cÃ¢u lá»‡nh Query VBA, Ká»³ bÃ¡o cÃ¡o vÃ  cÃ¡c Ä‘iá»u kiá»‡n Ä‘á»ƒ hoÃ n tiá»n
```
### CÃ¡c bÆ°á»›c cháº¡y bÃ¡o cÃ¡o:
- BÆ°á»›c 01: ÄÆ°a dá»¯ liá»‡u Ä‘áº§u vÃ o cá»§a Authorization Transaction vÃ  Settlement Transaction tÆ°Æ¡ng á»©ng vÃ o 2 sheet Data: Auth vÃ  Settle.
- BÆ°á»›c 02: Thay Ä‘á»•i cÃ¡c thiáº¿t láº­p vá» Ä‘iá»u kiá»‡n (Náº¿u cáº§n) táº¡i sheet Note:
+ Chá»‰ tiÃªu xÃ©t hoÃ n tiá»n: Táº¡i Ã´ B32 vÃ  C32
+ Tá»· lá»‡ giao dá»‹ch tháº¥t báº¡i: Táº¡i Ã´ B30 vÃ  C30
+ GiÃ¡ trá»‹ trung bÃ¬nh cá»§a má»—i giao dá»‹ch: Táº¡i Ã´ B31 vÃ  C31
- BÆ°á»›c 03: Thay Ä‘á»•i tá»· lá»‡ hoÃ n tiá»n: Thiáº¿t láº­p Ä‘iá»u kiá»‡n táº¡i vÃ¹ng B36:D43
- BÆ°á»›c 04: Thay Ä‘á»•i ká»³ bÃ¡o cÃ¡o:
+ NgÃ y: Táº¡i Ã´ B22 (ThÆ°á»ng sáº½ Ä‘iá»n lÃ  ngÃ y cuá»‘i cÃ¹ng cá»§a thÃ¡ng)
ChÃº Ã½: Náº¿u cáº§n bÃ¡o cÃ¡o theo ngÃ y (khÃ´ng lÃ  toÃ n bá»™ thÃ¡ng) thÃ¬ tÃ­ch "v" táº¡i Ã´ D22, máº·c Ä‘á»‹nh lÃ  khÃ´ng tÃ­ch.
+ ThÃ¡ng: Táº¡i Ã´ B23
+ NÄƒm: Táº¡i Ã´ B24
- BÆ°á»›c 5: Chá»n nÃºt **RUN** Ä‘á»ƒ cháº¡y bÃ¡o cÃ¡o

[ğŸ” Quay vá» Ä‘áº§u](#má»¥c-lá»¥c)

## Chi tiáº¿t vá» dá»± Ã¡n
### Cáº¥u trÃºc File
```
Cash back Project/
â”œâ”€â”€ Code/                            # Folder tá»•ng chá»©a pháº§n code VBA vÃ  query SQL Ä‘Æ°á»£c tÃ¡ch riÃªng Ä‘á»ƒ dá»… theo dÃµi
â”‚   â”œâ”€â”€ Cashback Query.sql           # File chá»©a toÃ n bá»™ query SQL Ä‘Æ°á»£c sá»­ dá»¥ng trong Project
â”‚   â””â”€â”€ Cashback VBA.bas             # File chá»©a toÃ n bá»™ code VBA Ä‘Æ°á»£c sá»­ dá»¥ng trong Project
â”œâ”€â”€ Data/
â”‚   â””â”€â”€ Data.xlsx                    # Dá»¯ liá»‡u sample Ä‘áº§u vÃ o Ä‘á»ƒ cháº¡y thá»­ cho Project
â”œâ”€â”€ image/                           # ThÆ° má»¥c chá»©a hÃ¬nh áº£nh minh há»a
â”œâ”€â”€ Report/
â”‚   â””â”€â”€ Cashback Report for date of 2025.06.xlsb   # BÃ¡o cÃ¡o hoÃ n thiá»‡n Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i gá»“m Code vÃ  Data
â””â”€â”€ README.md                        # TÃ i liá»‡u hÆ°á»›ng dáº«n
```

### Cáº¥u trÃºc cÃ¢u lá»‡nh cháº¡y tá»± Ä‘á»™ng
Cáº¥u trÃºc cá»§a cÃ¢u lá»‡nh Ä‘Æ°á»£c Ä‘Æ°á»£c chia thÃ nh 3 sub chÃ­nh
```
AllStep/
â”œâ”€â”€ Step1/                 # ChÆ°Æ¡ng trÃ¬nh con Ä‘á»ƒ táº¡o sheet Check1
â”‚   â”œâ”€â”€ SQL_check1         # Sá»­ dá»¥ng VBA Ä‘á»ƒ dÃ¹ng ADO SQL Ä‘Ãª láº¥y dá»¯ liá»‡u trÃªn sheet1
â”‚   â””â”€â”€ Check1             # Sá»­ dá»¥ng VBA Ä‘á»ƒ tá»± Ä‘á»™ng táº¡o cÃ´ng thá»©c hÃ m Ä‘á»ƒ kiÃªm tra láº¡i káº¿t quáº£ Query
â”œâ”€â”€ Step2/
â”‚   â”œâ”€â”€ SQL_check2         # Sá»­ dá»¥ng VBA Ä‘á»ƒ dÃ¹ng ADO SQL Ä‘Ãª láº¥y dá»¯ liá»‡u trÃªn sheet2
â”‚   â””â”€â”€ Check2             # Sá»­ dá»¥ng VBA Ä‘á»ƒ tá»± Ä‘á»™ng táº¡o cÃ´ng thá»©c hÃ m Ä‘á»ƒ kiÃªm tra láº¡i káº¿t quáº£ Query
â””â”€â”€ Step3/
    â”œâ”€â”€ Check3             # Sá»­ dá»¥ng VBA Ä‘á»ƒ tá»± Ä‘á»™ng gá»™p dá»¯ liá»‡u sheet1, sheet2, kiá»ƒm tra cÃ¡c khÃ¡ch Ä‘á»§ Ä‘iá»u kiá»‡n Ä‘Æ°á»£c hoÃ n tiá»n vÃ  sá»‘ tiá»n Ä‘Æ°á»£c hoÃ n
    â””â”€â”€ SQL_Report         # Sá»­ dá»¥ng SQL Ä‘á»ƒ Query cÃ¡c trÆ°á»ng há»£p Ä‘á»§ Ä‘iá»u kiá»‡n Ä‘Æ°á»£c hoÃ n tiá»n
```

Trong Ä‘Ã³:
- NhÃ³m chÆ°Æ¡ng trÃ¬nh con VBA: SQL_check1, SQL_check2, SQL_Report Ä‘á»u sá»­ dá»¥ng cÃ¡c cÃ¢u Ä‘á»ƒ gá»i ADO SQL chá»‰ Ä‘áº¿n Ã´ dá»¯ liá»‡u chá»©a cÃ¢u lá»‡nh Query SQL:
+ **SQL_check1**: Chá»‰ Ä‘áº¿n cÃ¢u Query SQL táº¡i Ã´ A13 táº¡i sheet Note
```sql
SELECT S.User_ID,S.KYC_Name,S.Pay_Currency,SUM(S.Pay_Amount),AVG(S.Pay_Amount) 
FROM [Settle$] S 
GROUP BY S.User_ID,S.KYC_Name,S.Pay_Currency  
ORDER BY SUM(S.Pay_Amount) DESC										
```
![1754233743111](image/README/1754233743111.png)

+ **SQL_check2**: Chá»‰ Ä‘áº¿n cÃ¢u Query SQL táº¡i Ã´ A16 táº¡i sheet Note
```sql
SELECT User_ID,KYC_Name,SUM(IIF(Status=""DECLINED"",1,0)),SUM(1),SUM(IIF(Status=""DECLINED"",1,0))/SUM(1)
FROM [Auth$] 
GROUP BY User_ID,KYC_Name 
ORDER BY User_ID ASC										
```
![1754233789013](image/README/1754233789013.png)

+ **SQL_Report**: Chá»‰ Ä‘áº¿n cÃ¢u Query SQL táº¡i Ã´ A19 táº¡i sheet Note
```sql
SELECT User_ID,KYC_Name,Pay_Currency,Pay_Amount,Average_Pay_Amount,Declined_rate,Cash_back_Amount,Current_Cash_back_rate 
FROM [Check3$] 
WHERE Check_conditions=TRUE 
ORDER BY Pay_Amount DESC										
```
![1754233882244](image/README/1754233882244.png)


### Kháº£ nÄƒng nÃ¢ng cáº¥p
- BÃ¡o cÃ¡o linh hoáº¡t trong trÆ°á»ng há»£p cÃ¡c Ä‘iá»u kiá»‡n vÃ  tá»· lá»‡ hoÃ n tiá»n thay Ä‘á»•i.
- Dá»… dÃ ng tuá»³ biÃªn Ä‘á»ƒ láº¥y dá»¯ liá»‡u trá»« 1 file Ä‘á»™c láº­p riÃªng biá»‡t

[ğŸ” Quay vá» Ä‘áº§u](#má»¥c-lá»¥c)

## GÃ³p Ã½ vÃ  Ä‘Ã³ng gÃ³p
Ráº¥t hy vá»ng nháº­n Ä‘Æ°á»£c gÃ³p Ã½ vÃ  Ä‘Ã³ng gÃ³p cá»§a má»i ngÆ°á»i Ä‘á»ƒ hoÃ n thiá»‡n hÆ¡n
Má»i gÃ³p Ã½ vÃ  Ä‘Ã³ng gÃ³p xin gá»­i vá»: buithanhbinh55.aof@gmail.com

## LÆ°u Ã½
Dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng táº¡i BÃ¡o cÃ¡o lÃ  dá»¯ liá»‡u máº«u, Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hoÃ¡ Ä‘á»ƒ cÃ³ thá»ƒ tÆ°Æ¡ng thÃ­ch vá»›i dá»¯ liá»‡u thá»±c táº¿

[ğŸ” Quay vá» Ä‘áº§u](#má»¥c-lá»¥c)